{
	"$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"serviceBusName": {
			"type": "string"
		},
		"topicName": {
			"type": "string"
		},
		"subscriptionNames": {
			"type": "array"
		}
	},
	"variables": {
	},
	"resources": [
		{
			"type": "Microsoft.ServiceBus/namespaces/topics",
			"apiVersion": "2017-04-01",
			"name": "[concat(parameters('serviceBusName'), '/', parameters('topicName'))]",
			"location": "[resourceGroup().location]",
			"properties": {
				"defaultMessageTimeToLive": "P366D",
				"maxSizeInMegabytes": 1024,
				"requiresDuplicateDetection": false,
				"duplicateDetectionHistoryTimeWindow": "PT10M",
				"enableBatchedOperations": true,
				"status": "Active",
				"supportOrdering": false,
				"autoDeleteOnIdle": "P427D",
				"enablePartitioning": false,
				"enableExpress": false
			},
			"resources": [
				{
					"type": "Microsoft.ServiceBus/namespaces/topics/subscriptions",
					"apiVersion": "2017-04-01",
					"name": "[variables('subscriptionNames').[copyIndex()]]",
					"location": "[resourceGroup().location]",
					"properties": {
						"lockDuration": "PT30S",
						"requiresSession": false,
						"defaultMessageTimeToLive": "P14D",
						"deadLetteringOnMessageExpiration": true,
						"deadLetteringOnFilterEvaluationExceptions": false,
						"maxDeliveryCount": 10,
						"status": "Active",
						"enableBatchedOperations": false,
						"autoDeleteOnIdle": "P427D"
					},
					"dependsOn": [
						"[concat(parameters('serviceBusName'), '/', parameters('topicName'))]"
					],
					"copy": {
						"name": "subscriptionsCopy",
						"count": "[length(variables('subscriptionNames'))]"
					}
				}
			]
		}
	],
	"outputs": {
	}
}
